# DB-Assignment-1
# üìö Bookstore Database (`bookstore02`)

## –¢–∞–±–ª–∏—Ü—ñ

### 1. `authors`

–ú—ñ—Å—Ç–∏—Ç—å –¥–∞–Ω—ñ –ø—Ä–æ –∞–≤—Ç–æ—Ä—ñ–≤.

| –ü–æ–ª–µ        | –¢–∏–ø          | –û–ø–∏—Å                      |
|-------------|---------------|---------------------------|
| `author_id` | INT, PK, AI   | –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID –∞–≤—Ç–æ—Ä–∞      |
| `name`      | VARCHAR(100)  | –Ü–º‚Äô—è –∞–≤—Ç–æ—Ä–∞               |
| `au_country`| VARCHAR(100)  | –ö—Ä–∞—ó–Ω–∞                    |
| `birth_year`| INT           | –†—ñ–∫ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è            |

 **–ó–≤'—è–∑–∫–∏:** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É —Ç–∞–±–ª–∏—Ü—ñ `books`

---

### 2. `books`

–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–Ω–∏–≥–∏, –¥–æ—Å—Ç—É–ø–Ω—ñ —É –º–∞–≥–∞–∑–∏–Ω—ñ.

| –ü–æ–ª–µ            | –¢–∏–ø          | –û–ø–∏—Å                        |
|------------------|---------------|-----------------------------|
| `book_id`        | INT, PK, AI   | –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID –∫–Ω–∏–≥–∏         |
| `title`          | VARCHAR(100)  | –ù–∞–∑–≤–∞ –∫–Ω–∏–≥–∏                 |
| `author_id`      | INT, FK       | –ê–≤—Ç–æ—Ä (–∑ —Ç–∞–±–ª–∏—Ü—ñ `authors`) |
| `price`          | INT           | –¶—ñ–Ω–∞ (–≤ —É–º–æ–≤–Ω–∏—Ö –æ–¥–∏–Ω–∏—Ü—è—Ö)   |
| `published_year` | INT           | –†—ñ–∫ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó              |

 **–ó–≤'—è–∑–∫–∏:** –ø–æ—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ `authors.author_id`

---

### 3. `customers`

–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –∫–Ω–∏–∂–∫–æ–≤–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω—É.

| –ü–æ–ª–µ         | –¢–∏–ø          | –û–ø–∏—Å                  |
|--------------|---------------|-----------------------|
| `customer_id`| INT, PK, AI   | –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID         |
| `name`       | VARCHAR(100)  | –Ü–º‚Äô—è –∫–ª—ñ—î–Ω—Ç–∞          |
| `email`      | VARCHAR(100)  | Email-–∞–¥—Ä–µ—Å–∞          |
| `country`    | VARCHAR(100)  | –ö—Ä–∞—ó–Ω–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–Ω—è     |

 **–ó–≤'—è–∑–∫–∏:** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É —Ç–∞–±–ª–∏—Ü—ñ `orders`

---

### 4. `orders`

–ú—ñ—Å—Ç–∏—Ç—å –∑–∞–≥–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ–∂–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è.

| –ü–æ–ª–µ          | –¢–∏–ø        | –û–ø–∏—Å                        |
|---------------|-------------|-----------------------------|
| `orders_id`   | INT, PK, AI | –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è    |
| `customer_id` | INT, FK     | ID –∫–ª—ñ—î–Ω—Ç–∞ (–∑ `customers`)  |
| `order_date`  | DATE        | –î–∞—Ç–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è             |
| `total_amount`| INT         | –ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è    |

 **–ó–≤'—è–∑–∫–∏:** –ø–æ—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ `customers.customer_id`

---

### 5. `order_items`

–î–µ—Ç–∞–ª—ñ–∑—É—î –≤–∏–∫–æ–Ω–∞–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

| –ü–æ–ª–µ            | –¢–∏–ø        | –û–ø–∏—Å                            |
|------------------|-------------|---------------------------------|
| `orders_item_id` | INT, PK, AI | –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID –ø–æ–∑–∏—Ü—ñ—ó           |
| `order_id`       | INT, FK     | ID –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (–∑ `orders`)      |
| `book_id`        | INT, FK     | ID –∫–Ω–∏–≥–∏ (–∑ `books`)            |
| `quantity`       | INT         | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –æ–¥–∏–Ω–∏—Ü—å —Ü—ñ—î—ó –∫–Ω–∏–≥–∏    |

 **–ó–≤'—è–∑–∫–∏:** `order_id` ‚Üí `orders.orders_id`, `book_id` ‚Üí `books.book_id`



# üìä –ó–∞–ø–∏—Ç: –ê–∫—Ç–∏–≤–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∏ –∑ –ø–µ–≤–Ω–∏–º–∏ –≤–∏—Ç—Ä–∞—Ç–∞–º–∏ (–£–∫—Ä–∞—ó–Ω–∞ —Ç–∞ –°–®–ê)

–¶–µ–π –∑–∞–ø–∏—Ç –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –∫–ª—ñ—î–Ω—Ç—ñ–≤ –∑ –£–∫—Ä–∞—ó–Ω–∏ —Ç–∞ –°–®–ê, —è–∫—ñ:

- –∑–¥—ñ–π—Å–Ω–∏–ª–∏ **—â–æ–Ω–∞–π–º–µ–Ω—à–µ 2 –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è**,
- –≤–∏—Ç—Ä–∞—Ç–∏–ª–∏ **–ø–æ–Ω–∞–¥ 100 –æ–¥–∏–Ω–∏—Ü—å –≤–∞–ª—é—Ç–∏** –Ω–∞ –∫–Ω–∏–≥–∏.

–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–æ –∑–∞ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è–º —Å—É–º–∏ –≤–∏—Ç—Ä–∞—Ç, –≤–∏–≤–æ–¥—è—Ç—å—Å—è **–¥–æ 10 –∑–∞–ø–∏—Å—ñ–≤**.

###  SQL-–∫–æ–¥ –∑ –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º–∏

```sql
WITH totals AS (
    SELECT 
        c.customer_id,
        c.name,
        c.country,

        SUM(b.price * oi.quantity) AS sum_books,           --  –ó–Ω–∞—Ö–æ–¥–∏–º–æ –∑–∞–≥–∞–ª—å–Ω—É —Ü—ñ–Ω—É –∑–∞ –∫—É–ø–ª–µ–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–Ω–∏–∂–æ–∫ –∫–æ–∂–Ω–∏–º –ø–æ–∫—É–ø—Ü–µ–º
        COUNT(DISTINCT o.orders_id) AS orders_count        --  –ü—ñ–¥—Ä–∞—Ö–æ–≤—É—î–º–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å, –∑—Ä–æ–±–ª–µ–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º
    FROM orders o
    LEFT JOIN customers c ON o.customer_id = c.customer_id --  –ü—Ä–∏—î–¥–Ω—É—î–º–æ —Ç–∞–±–ª–∏—Ü—é –∫–ª—ñ—î–Ω—Ç—ñ–≤, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
    LEFT JOIN order_items oi ON o.orders_id = oi.order_id  --  –ü—Ä–∏—î–¥–Ω—É—î–º–æ —Ç–∞–±–ª–∏—Ü—é –∑ –ø–æ–∑–∏—Ü—ñ—è–º–∏ –∑–∞–º–æ–≤–ª–µ–Ω—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –ø—Ä–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
    LEFT JOIN books b ON oi.book_id = b.book_id            --  –ü—Ä–∏—î–¥–Ω—É—î–º–æ —Ç–∞–±–ª–∏—Ü—é –∫–Ω–∏–∂–æ–∫, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —ó—Ö —Ü—ñ–Ω—É
    GROUP BY c.customer_id, c.name, c.country              --  –ì—Ä—É–ø—É—î–º–æ –∑–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –∞–≥—Ä–µ–≥–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
    HAVING 
        SUM(b.price * oi.quantity) > 100 AND               --  –í—Ä–∞—Ö–æ–≤—É—î–º–æ –ª–∏—à–µ —Ç–∏—Ö, —Ö—Ç–æ –≤–∏—Ç—Ä–∞—Ç–∏–≤ –ø–æ–Ω–∞–¥ 100 –æ–¥.
        COUNT(DISTINCT o.orders_id) >= 2                   --  –Ü –∑—Ä–æ–±–∏–≤ —â–æ–Ω–∞–π–º–µ–Ω—à–µ 2 –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
)

SELECT * FROM totals WHERE country = 'Ukraine'             --  –û–±–∏—Ä–∞—î–º–æ –ø–æ–∫—É–ø—Ü—ñ–≤ –∑ –£–∫—Ä–∞—ó–Ω–∏
UNION
SELECT * FROM totals WHERE country = 'United States'       --  –î–æ–¥–∞—î–º–æ –ø–æ–∫—É–ø—Ü—ñ–≤ –∑—ñ –°–®–ê
ORDER BY sum_books ASC                                     --  –°–æ—Ä—Ç—É—î–º–æ –∑–∞ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è–º —Å—É–º–∏ –≤–∏—Ç—Ä–∞—Ç
LIMIT 10;                                                  --  –û–±–º–µ–∂—É—î–º–æ –¥–æ 10 —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

